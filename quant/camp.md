# CAMP模型
## 效用模型
### 效用函数
$$\Large \mu(x)  $$, 输入： 财富总额。 输出： 给人带来多少效用，如满足感和便利性  
 
一般具有两个性质

1. $$如果 x \le y , 则：\mu(x) \le \mu(y) $$. 对于一个人来说，钱越多越好
2. $$如果 d \ge 0, 并且 x \le y, 则： \mu(x + d) - \mu(x) \ge \mu(y+d) - \mu(y) $$  例：d=1w, x=20w, y=20000w,  显然， 当我们有20万时， 多1万给我们带来的效用远大于 2亿 + 1万。

### 效用函数是凹函数

$$\Large f(\frac{x+y}{2}) \ge \frac{f(x) + f(y)}{2}$$

### 预期效用假说
expected utitlity hypothesis: 如果一个投资者的效用函数是$$\mu(x)$$, 面对N种投资选项， 这些投资选项对应的财富结果用$$x_1, x_2, ..., x_n$$表示 , 则投资者会选择 $$E[\mu(x)] $$ 最大的选项 。

## 风险模型

### 风险和收益

- 高风险高收益 或 “鸡蛋不要放在一个篮子里” 背后的逻辑是什么？ 背后可以用效用函数来解释
- 一个投资项目： 50%的可能赚10万， 50%的可能赔10万， 这是一个“高风险高收益”的项目么？  不是。 在收益期望是0， 但在效用函数的层面， 赚10万带来的效用低于亏10万。 效用的期望是负的。故正常的投资者应该拒绝该投资选项

### 风险厌恶

- 如果一个投资选项A的回报用随机变量X表示， 则期望收益是E[X]. 
- 再假设一个投资者的效用函数是$$\mu(x)$$, 当前的财富是$$x_0$$, 
- 该投资者投资项目A后的财富： $$x_0 + X$$ , 投资后的效用为：$$\mu(x_0 + X)$$ , 额外效用：$$\mu(x_0 + X) - \mu(x_0)$$
- 则投资A带来的期望效用：　$$E[\mu(x_0 + X) - \mu(x_0)]$$  如果期望为负， 则不投资。

#### 零收益投资
- 对于一个随机变量R， E[R] = 0 , 我们说R是一个零收益投资
- 设$$\mu$$ 是一个正常的效用函数， $$x_0 \ge 0 , R为零收益投资， 则 E[\mu(x_0 + R)] \le \mu(x_0) $$

也就是说， 一项没有预期收益的投资，一个效用函数“正常”的投资者， 在预期上是损失效用的。

定义： 如果一个投资者的效用函数 $$\mu(x)$$ 是正常的， 我们说他是厌恶风险的。

投资的风险在于： 收益的不确定性。 任何投资X都可以被写成预期收益E[X] 和零收益投资 X - E[x] 两部分的加和，其中零收益部分带来预期效用的下降，所以需要足够大的E[X]来弥补。 这里的E[x]被定义为这项投资的 风险溢价：risk premium . 只有当风险溢价带来的高于风险所带来的效用折扣时， 投资者才愿意进行投资。

### 分散风险
经济学中的风险指： 未来的不确定性。从概率学的角度来讲， 一个随机变量的分布越散， 它的确定性就越低。因此有一个简易的衡量风险的标准， 就是收益变量的标准差$$\sigma$$。
一般来讲，在保持 E[X]不变的情况下，我们希望 $$\sigma_x$$越低越好。下面就讲一个例子。

### 对投资者的假设
定义：对于一个投资者，如果任意两个投资回报率的随机变量 X 和 Y 满足 E[X]≥E[Y] 并且 $$\sigma_x < \sigma_y$$（也就是说预期收益更大但是风险更小），该投资者会选择X，那么我们说这个投资者是“理智”的。

## MPT模型
### 概述

金融资产配置的目标是将投资资金合理的分配在多种资产上，在将风险控制在一定的范围之内的同时把收益率最大化。其中最著名的是现代资产配置理论：modern portfolio theory. 核心思想是： 最小化标准差的同时， 最大化预期收益来配置资产， 有时也称： mean-variance analysis. 均值方差分析。

### 模型和假设

- 假设： 投资者对一个风险资产的认识 等同于 该资产收益率变量的标准差。
- 因此任何一个资产或者资产组合都可以根据其收益和风险被放在一个二维坐标图上。 横轴是收益率的标准差。 竖轴是：收益率的期望值。
- 投资者追求的是低风险 且 收益高的资产配置。因此 固定收益不变， 我们要将风险降到最低，也就是要得到最小的横轴值。 或者固定风险不变， 将收益率提到最高， 我们将得到最大的竖轴值。
- 假设市面上有n种金融资产,  对于某项资产i, 表示其收益率的随机变量为$$r_i， E[r_i]表示期望收益， \sigma_i表示收益变量的标准差$$, 我们将市面上所有收益率方差大于0 的叫做风险资产（risk assts） 。将收益率没有不确定性的资产叫做无风险资产(risk-free assts). 并且假设市场上所有无风险资产的收益率是一样的， 叫做无风险利率（risk-free interest rate ）, 写作$$r_f$$.
- 一个风险资产配置(risky portfolio ) P 是由风险资产i = 1, 2, ..., n按照某个权重比例组成的， 每个资产i在P中的权重记作$$w_i$$, 满足$$\sum_{i=1}^nw_i = 1$$. 我们假设市场是完全开放的， 可以自由的做多或做空。 根据单个资产的收益率， 我们可以计算P的收益率， 首先资产组合收益率的随机变量是：<br/>
 $$\Large r_p = \sum_{i=1}^n w_i * r_i$$ <br/>
$$\Large 预期收益：E[r_p] = E[\sum_{i=1}^n w_i * r_i] = \sum_{i=1}^nw_i E[r_i]$$ <br/>
$$\Large 方差:  Var(r_p) = E[(r_p - E[r_p])^T(r_p - E[r_p])] = \sum_{i=1}^n\sum_{j=1}^nw_i w_j Cov(r_i, r_j)$$
$$\Large 标准差： \sigma_p = \sqrt{Var(r_p)}$$

 
### 有效前沿

现在我们固定预期收益， 然后拥有该预期收益， 并且标准差最小的资产组合。  也就是说， 对于任意一个预期收益值$$\mu$$,  找到一个资产配置权重为$$w=(w_1, w_2, ..., w_n)的资产组合P. 要求P的预期收益为 \mu, 并且在所有可选的资产组合中， P的方差是最小的。 用最优化的问题表示就是：$$ <br/>
$$\Large 最小化  Var(r_p) = \sum_{i=1}^n\sum_{j=1}^nw_i w_j Cov(r_i, r_j)$$ <br/>
$$\Large 满足 E[r_p] = E[\sum_{i=1}^n w_i * r_i] = \mu $$ <br/>
$$\Large 满足 \sum_{i=1}^n w_i = 1$$

有约束的凸优化问题， largrange乘子法解决。  将这些最优解画成图，在标准差--预期坐标上， 得到一个抛物线。
![avatar](https://image.joinquant.com/7509fe497b1a1106a0b7e9fb317ff998)
这条曲线叫做：有效前沿， efficient frontier.  由于它的形状像一个子弹， 因此也叫：马科维兹子弹。 有效前沿存在一个波动率最小的地方，也就是曲线最靠左的地方， 并且在这个点以上的位置才是有效的。

### 加入无风险资产
有效前沿左侧的区域是通过风险资产无法配置出来的。 但是， 如果无风险资加入配置， 那么左侧的一些位置可以获取。
我们选择有效前沿上的一个资产配置P， 并选择 比例 $$\alpha \ge 0$$, 将本金的$$\alpha$$ 配置于P， $$1 - \alpha$$ 配置于无风险资产。 当 $$\alpha \gt 1$$时， 我们称贷款本金的$$\alpha - 1$$倍， 支付无风险利率，并用贷款以及本金配置P， 如此， 以$$\alpha$$为系数， 使用P和无风险资产配置的一个资产组合 ， 我们将它的收益随机变量记为$$r_\alpha$$ 计算得到: <br/>
$$\Large E[r_p] = E[\alpha r_p * (1 - \alpha)r_f]$$<br/>
$$\Large \sigma_{\alpha} = \sqrt{Var(\alpha r_p * (1 - \alpha)r_f])} = \sqrt{\alpha^2Var(r_p)} = \alpha \sigma_p$$ 
![avatar](https://image.joinquant.com/7578cdff5a4fd47a86c4568163b4d48e)
如上图所示，蓝点是无风险收益利率， 红点是有效前沿上的风险资产配置P， 那么黄线上的所有点都是可以按照一定比例配置无风险资产和资产配置P得到的。 该射线的斜率为夏普比例（sharpe ratio）<br/>
$$\Large S_p := \frac{E[r_p] -r_f}{\sigma_p - \sigma_{rf}} = \frac{E[r_p] -r_f}{\sigma_p}$$

### 市场组合和资本线
经计算可以证明， 用市场信息计算得来的有效前沿上必定有一个夏普比例最高的点， 我们叫做市场组合（market portfolio）
![avatar](https://image.joinquant.com/af3f77f9b9f514761462c1add904d8b3)
图中的蓝点是无风险资产，红点是市场组合，穿过它们的射线叫做资本市场线(capital market line)。红点和蓝点之间的位置是将一份资金存于无风险资产，并将余下资金买入市场组合而得到的；红点右侧的位置是以无风险利率进行一些贷款，并将本金连同贷款全部买入市场组合的配置。
设无风险资产利率为$$r_f$$, 市场组合为M， 并且市场组合的夏普比例为$$S_M$$的话，资本市场线的公式为：
$$\Large \mu = r_f * S_M * \sigma$$
资本市场线的意义在于，固定标准差，那么市场上收益预期最高的投资组合在这条线上；或者，固定预期收益，那么市场上标准差最低的投资组合在这条线上。所以，资本配置线可以直观地理解为理论上的“最佳配置线”。

## CAMP模型
全称Capital Asset Pricing Model, 资本资产定价模型。搭建在markowitz的现代资产配置理论（MPT） 之上，该模型用简单的数学公式表述了资产的收益率与风险系数$$\beta$$以及系统性风险之间的关系。 尽管CAPM的假设偏于牵强，结论也常与实验证据违背， 但它一直是金融经济学中重要的理论， 为更好的模型打下了基础

### 模型假设
CAPM 模型是一个理论性很强的模型， 它所假设的金融市场有一个非常简单的框架。它假设：市场上所有投资者对于风险和收益的评估仅限于收益变量的预期值和标准差的分析。 而且所有投资是完全理智的， 并且市场是完全公开的， 所有投资都的信息与机会是均等的， 任何人都可以以唯一的无风险利率无限制的贷款或借出。 因此所有的投资都可以得到同样的有效前沿和资本线。

![avatar](https://image.joinquant.com/484b0dfd9f005f9fccfdc62474ace055)

为了最大化预期收益并最小化标准差，所有投资者必定选择资本市场线上的一点作为资产配置。也就是说，所有投资者都按一定比例持有现金和市场组合 M。因此， M 是名副其实的“市场组合”，因为整个市场都是按照这个组合来分配资产的。所以 M 的波动性和不确定性不单单是市场组合的风险，也是整个市场的风险，叫做系统性风险(systematic risk)。

### CAPM 公式
对于某一项风险资产S，有<br/>
$$E[r_s] = r_f + \beta_s * (E[r_m] - r_f)$$ <br/>
其中：
- $$r_s$$ 是组合S的收益变量
- $$r_m$$ 是市场组合M的收益变量
- $$r_f$$ 是市场的无风险利率 
- $$\beta_s$$ 是组合S对于市场风险的敏感度， 计算公式如下： <br/>
 $$\beta_s = \frac{Cov(r_s, r_m)}{Var(r_m)}$$

<br/>
<br/>
<br/>
<br/>











